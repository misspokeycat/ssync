<!doctype html>
<html>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  <body>
      <div id="player"></div>
      </br>
      <form>
        Enter a vidid: <input id="vidid" type="text">
      </form>
      <script type="text/javascript">
          var currentvideo = 'M7lc1UVf-VE';
          var tag = document.createElement('script');
          tag.src = "https://www.youtube.com/iframe_api";
          var firstScriptTag = document.getElementsByTagName('script')[0];
          firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
          var player;
          function onYouTubeIframeAPIReady(){
            player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: currentvideo,
            events: {
              'onReady' : onPlayerReady,
              'onStateChange' : onPlayerStateChange
            }
          });
        }
        function onPlayerReady(event){
          event.target.playVideo();
        }
        var done = false;
        function onPlayerStateChange(event){
          //TODO: Add time synchronization
        }
      </script>
      <script type="text/javascript">
        var socket = io();
        //This sends the vidid in the vidid field to the server
        $('form').submit(function(){
          socket.emit('video id', $('#vidid').val());
        });
        //This handles reciept of video ids.
        socket.on('video id', function(vid){
          //Sets youtube player to selected video
          currentvideo = vid;
          if (player != null){
            player.loadVideoById(currentvideo);
          }
        });
      </script>
  </body>
</html>